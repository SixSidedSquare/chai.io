(function(){function n(e){return e[0]}function r(e){return e[1]}function i(e,t,n){return n=="offset"?function(n){return"translate(0,"+(n+(n<0)-e)*t+")"}:function(n){return(n<0?"scale(1,-1)":"")+"translate(0,"+(n-e)*t+")"}}d3.horizon=function(){function d(n){n.each(function(n,r){var d=d3.select(this),v=2*s+1,m=Infinity,g=-Infinity,b=-Infinity,E,S,T,N=n.map(function(e,t){var n=a.call(this,e,t),r=f.call(this,e,t);return n<m&&(m=n),n>g&&(g=n),-r>b&&(b=-r),r>b&&(b=r),[n,r]}),C=d3.scale.linear().domain([m,g]).range([0,l]),k=d3.scale.linear().domain([0,b]).range([0,c*s]),L=i(s,c,o);this.__chart__?(E=this.__chart__.x,S=this.__chart__.y,t0=this.__chart__.t,T=this.__chart__.id):(E=C.copy(),S=k.copy(),t0=L,T=++t);var A=d.selectAll("defs").data([null]);A.enter().append("defs").append("clipPath").attr("id","d3_horizon_clip"+T).append("rect").attr("width",l).attr("height",c),A.select("rect").transition().duration(h).attr("width",l).attr("height",c),d.selectAll("g").data([null]).enter().append("g").attr("clip-path","url(#d3_horizon_clip"+T+")");var O=d.select("g").selectAll("path").data(d3.range(-1,-s-1,-1).concat(d3.range(1,s+1)),Number),M=e.interpolate(u).x(function(e){return E(e[0])}).y0(c*s).y1(function(e){return c*s-S(e[1])})(N),_=e.x(function(e){return C(e[0])}).y1(function(e){return c*s-k(e[1])})(N);O.enter().append("path").style("fill",p).attr("transform",t0).attr("d",M),O.transition().duration(h).style("fill",p).attr("transform",L).attr("d",_),O.exit().transition().duration(h).attr("transform",L).attr("d",_).remove(),this.__chart__={x:C,y:k,t:L,id:T}}),d3.timer.flush()}var s=1,o="offset",u="linear",a=n,f=r,l=960,c=40,h=0,p=d3.scale.linear().domain([-1,0,1]).range(["#d62728","#fff","#1f77b4"]);return d.duration=function(e){return arguments.length?(h=+e,d):h},d.bands=function(e){return arguments.length?(s=+e,p.domain([-s,0,s]),d):s},d.mode=function(e){return arguments.length?(o=e+"",d):o},d.colors=function(e){return arguments.length?(p.range(e),d):p.range()},d.interpolate=function(e){return arguments.length?(u=e+"",d):u},d.x=function(e){return arguments.length?(a=e,d):a},d.y=function(e){return arguments.length?(f=e,d):f},d.width=function(e){return arguments.length?(l=+e,d):l},d.height=function(e){return arguments.length?(c=+e,d):c},d};var e=d3.svg.area(),t=0})();